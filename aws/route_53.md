# Route53

AWSが提供する権威DNSサーバーで、ポート53で動作することからRoute53と呼ばれる

- 主要機能はドメイン登録/ DNS ルーティング/ヘルスチェックの3つ
- ポリシーによるルーティング設定
  - トラフィックルーティング/フェイルオーバー/トラフィックフローに基づく様々な条件のルーティング設定が可能
- AWS 側で100%可用性を保証する SLA
  - 絶対に落ちない
- マネージドサービスとして提供しており、ユーザー側で冗長性などを考慮する必要がない

## 利用方法

1. ドメインを設定
2. ドメイン名と同じホストゾーンを自動生成
3. ホストゾーンにルーティング方法となる DNS レコードを作成
4. トラフィックルーティングを設定

## ホストゾーン

ドメインとそのサブドメインのトラフィックのルーティングする方法について情報を保持するコンテナ

- パブリックホストゾーン
- プライベートホストゾーン

## DNS レコード

- SOA
  - ドメインの DNS サーバー/ドメイン管理者のメールアドレス/シリアル番号等を保持して、ゾーン転送時に情報が更新されているかの判断に利用する
- A
  - ホスト名と IP アドレスの関連付けを定義するレコード
- MX
  - メールの転送先（メールサーバ）のホスト名を定義するレコード
- CNAME
  - 正規ホスト名に対する別名を定義するレコード
  - 特定のホスト名を別のドメイン名に転送するときなどに利用する
- ALIAS レコード
  - DNS クエリに AWS サービスのエンドポイントの IP アドレスを返答
  - 以下のサービスを設定可能
    - 静的ウェブサイトとして設定された S3 バケット
    - CloudFront
    - ELB
    - ホストゾーン内のリソースレコードセット
  - AWS サービスに特化することで、レスポンスの高速化を実現

## トラフィックルーティンのタイプ

- シンプルルーティング
- 荷重ルーティング（Weighted）
  - 同じジョブを実行する複数のリソースがあり、各リソース (例: 2 つ以上の EC2 インスタンス) へのトラフィックの割合を指定する場合に使用する
  - Blue / Green デプロイメントに利用される
    - Blue/Greenデプロイメントとは、異なるバージョンのアプリケーションを実行する環境をそれぞれ1つずつ、つまり計2つ作成し、それらの環境間でトラフィックを移動（ブルー⇒グリーンへ移動）させることによって、アプリケーションの新バージョンをリリースするために利用される技術
- フェイルオーバールーティング（Failover）
- 複数値回答ルーティング（Multivalue）
  - 最大8つの別々のレコードを使用できる
  - ELB に近い
  - 一つ一つの IP アドレスに対してヘルスチェックをする
- レイテンシールーティング
  - レイテンシ、潜伏時間、潜時、待ち時間、反応時間とは、デバイスに対してデータ転送などを要求してから、その結果が返送されるまでの不顕性の高い遅延時間のこと
  - リージョンの遅延の少ないリージョンに返答する（基本的にはユーザーの最寄りリージョン）
- 位置情報ルーティング
  - ユーザーの IP アドレスにより位置情報を特定、地域ごとに異なるレコードを返す
  - ネットワーク構成に依拠しない、精度の高いレコードの区分けが可能
- 地理的近接性ルーティング
  - トラフィックフローの設定が必要
