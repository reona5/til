# Amazon ElastiCache

Cache を利用する AWS サービスには

- CloudFront
- ElastiCache
- S3

の3つがある。

- ElastiCache はメモリ + キャッシュというデータベース
  - 旧来のディスク型データベースに比べて、メモリ型データベースを使うことでデータの高速処理を実現
  - インメモリキャッシュは、キャッシュをメモリに保存する仕組み

## ユースケース

- セッション管理
- IoT処理とストリーム分析
- メタデータ蓄積
- ソーシャルメディアのデータ処理/分析
- Pub/Sub 処理
- DB キャッシュ処理
- アプリケーション上で即時反映が必要な場合
  - ユーザー同士のマッチング表示
  - ゲーム終了後のランキング表示

## 種類・特徴

- Redis
  - より複雑な設定ができる
  - シングルスレッドで動作する
  - すべてのデータ操作は排他的
  - スナップショット機能がある
  - データを永続化できる
  - Lua スクリプト
    - 移植性が高く、高速な実行速度などの特徴を持っているスクリプト言語
  - 位置情報クエリ
    - 軽度・緯度などの位置情報をクエリ処理することが可能
    - 検索距離や検索範囲の指定可能
  - pub/sub モデルの利用
    - イベントを起こす側とイベント処理を行う側を分離する
    - メッセージ処理やイベント処理で活用
- Memcached
  - シンプル
  - マルチスレッドで動作する
  - フェイルオーバーや復元ができない

## それぞれの用途

データベースというよりはキャッシュ処理用のレイヤーが欲しい場合には Memcached
データベースとしてインメモリバックアップをしたい場合は Redis

- Redis
  - 複雑なデータ型が必要
  - インメモリデータセットをソートまたはランク付けする必要がある
  - 読み込み処理の負荷に対して、リードレプリカにレプリケートする必要がある
  - pub/sub 機能が必要
  - 自動的なフェイルオーバーが必要
  - キーストアの永続性が必要
  - バックアップと復元機能が必要
  - 複数のデータベースをサポートする必要がある
- Memcached
  - シンプルなデータ型が必要
  - 複数のコアまたはスレッドを持つ大きなノードを実行する必要がある
  - システムでの需要の増減に応じてノードを追加または削除するスケールアウト及びスケールイン機能が必要
  - データベースなどのオブジェクトをキャッシュする必要がある
  - キーストアの永続性は必要ない
  - バックアップと復元の機能が必要でない
  - 複数のデータベースを利用できない
